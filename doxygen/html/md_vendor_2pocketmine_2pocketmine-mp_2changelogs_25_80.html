<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Doubacore: 5.0.0</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Doubacore<span id="projectnumber">&#160;0.2.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Recherche');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Chargement...</div>
<div class="SRStatus" id="Searching">Recherche...</div>
<div class="SRStatus" id="NoMatches">Aucune correspondance</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">5.0.0</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md1505"></a>Released 1st June 2023.</p>
<p><b>For Minecraft: Bedrock Edition 1.19.80</b></p>
<p>5.0.0 is a major feature update <a class="el" href="protocolto-p.html">to</a> PocketMine-MP, including support for Bedrock worlds from 1.13 onwards, a large array of new blocks and items, and various changes <a class="el" href="protocolto-p.html">to</a> the plugin API.</p>
<p>It is <b>not</b> compatible with plugins written for 4.x.y, and plugins may require code changes <a class="el" href="protocolto-p.html">to</a> work with it.</p>
<p><b>As this changelog is quite large, its accuracy and completeness cannot be guaranteed.</b> Make sure you're looking at the <a href="https://github.com/pmmp/PocketMine-MP/blob/stable/changelogs/5.0.md">latest revision</a>, as it may be amended after release.</p>
<h1><a class="anchor" id="autotoc_md1506"></a>
Core</h1>
<ul>
<li>Worlds are now saved according <a class="el" href="protocolto-p.html">to</a> the Bedrock 1.19.80 format.</li>
<li>Worlds generated by Bedrock from 1.13.0 and up are now supported (previously, only worlds up <a class="el" href="protocolto-p.html">to</a> 1.12 were supported).</li>
<li><code>/particle</code> now accepts strings for particle data instead of integers.</li>
<li><code>/particle</code> no longer accepts integers for block or item IDs.</li>
<li>The usage of <code>blockcrack</code>, <code>iconcrack</code> and <code>blockdust</code> particle types in <code>/particle</code> now follows the same pattern as other particle types, with the data for each being passed in the <code>data</code> parameter instead of being baked into the particle name.</li>
<li>Commands are now enabled by default in worlds exported from PocketMine-MP <a class="el" href="protocolto-p.html">to</a> Bedrock.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1507"></a>
Build system</h1>
<ul>
<li><code>build/generate-block-serializer-consts.php</code> has been added <a class="el" href="protocolto-p.html">to</a> generate <code>BlockTypeNames</code>, <code>BlockStateNames</code> and <code>BlockStateStringValues</code> in the <code>pocketmine\data\bedrock\block</code> package.</li>
<li><code>build/generate-item-type-names.php</code> has been added <a class="el" href="protocolto-p.html">to</a> generate <code>ItemTypeNames</code> in the <code>pocketmine\data\bedrock\item</code> package.</li>
<li><code>build/generate-runtime-enum-serializers.php</code> has been added <a class="el" href="protocolto-p.html">to</a> generate <code>RuntimeEnumSerializer</code>, <code>RuntimeEnumSerializerTrait</code>, and <code>RuntimeEnumSizeCalculatorTrait</code> in <code>pocketmine\data\runtime</code> package.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1508"></a>
Localization</h1>
<ul>
<li>Localized disconnect messages are now used in the following cases:<ul>
<li>Server full</li>
<li>Player not on the server whitelist</li>
<li>Player on the server ban list</li>
<li>Invalid skin</li>
<li>Invalid username</li>
<li>Kicked using <code>/kick</code></li>
<li>Banned using <code>/ban</code></li>
<li>Failure <a class="el" href="protocolto-p.html">to</a> find a safe spawn position</li>
</ul>
</li>
<li>Session open, session close and session player name discovery messages are now localized.</li>
<li>All permissions now have localized descriptions. These are not currently used by PocketMine-MP, but may be useful for plugins.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1509"></a>
Performance</h1>
<ul>
<li>Improved performance of dropping block inventory contents when the block is destroyed.</li>
<li>Improved light propagation performance by 10-15%.</li>
<li><a href="https://github.com/pmmp/ext-pmmpthread/releases/tag/6.0.0"><code>ext-pmmpthread</code> version 6.0.0</a> is now used, featuring significant performance improvements for thread-safe objects and various threading use-cases.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1510"></a>
Tools</h1>
<ul>
<li>The following tool scripts have been added:<ul>
<li><code>generate-block-palette-spec.php</code> - generates a JSON file with a readable overview of blocks, their state properties, and their possible values</li>
<li><code>generate-blockstate-upgrade-schema.php</code> - generates JSON blockstate upgrade schemas like those found in <a href="https://github.com/pmmp/BedrockBlockUpgradeSchema">BedrockBlockUpgradeSchema</a></li>
<li><code>generate-item-upgrade-schema.php</code> - generates JSON item ID/meta upgrade schemas like those found in <a href="https://github.com/pmmp/BedrockItemUpgradeSchema">BedrockItemUpgradeSchema</a></li>
<li><code>generate-bedrock-data-from-packets.php</code> - generates various files for <a href="https://github.com/pmmp/BedrockData">BedrockData</a><ul>
<li>This script accepts a txt file containing base64-encoded packet dumps.</li>
<li>This script has been in use for several years, but has only now been open-sourced.</li>
<li>It's used <a class="el" href="protocolto-p.html">to</a> generate data such as crafting recipes, creative inventory data, and various other blobs of data needed <a class="el" href="protocolto-p.html">to</a> support the current version of Minecraft: Bedrock Edition.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md1511"></a>
Gameplay</h1>
<h2><a class="anchor" id="autotoc_md1512"></a>
Blocks</h2>
<ul>
<li>Added the following new blocks:<ul>
<li>Amethyst Block</li>
<li>Ancient Debris</li>
<li>Azalea Leaves</li>
<li>Basalt</li>
<li>Blackstone blocks, slabs, stairs, and walls</li>
<li>Cakes with Candle &amp; Dyed Candle</li>
<li>Calcite</li>
<li>Candle &amp; Dyed Candle</li>
<li>Cartography Table (not currently usable due <a class="el" href="protocolto-p.html">to</a> maps not being implemented)</li>
<li>Cauldron</li>
<li>Cave Vines</li>
<li>Chain</li>
<li>Chiseled Deepslate</li>
<li>Chiseled Nether Bricks</li>
<li>Chiseled Polished Blackstone</li>
<li>Chorus Flower</li>
<li>Chorus Plant</li>
<li>Cobbled Deepslate blocks, slabs, stairs, and walls</li>
<li>Copper Ore</li>
<li>Copper block (random oxidation not yet implemented)</li>
<li>Crached Deepslate Tiles</li>
<li>Cracked Deepslate Bricks</li>
<li>Cracked Nether Bricks</li>
<li>Cracked Polished Blackstone Bricks</li>
<li>Crimson buttons, doors, fences, fence gates, hyphae, planks, pressure plates, signs, slabs, stairs, stems, and trapdoors</li>
<li>Crying Obsidian</li>
<li>Cut Copper block, stairs and slabs (random oxidation not yet implemented)</li>
<li>Deepslate</li>
<li>Deepslate Bricks blocks, slabs, stairs, and walls</li>
<li>Deepslate Ores (coal, copper, diamond, emerald, gold, iron, lapis lazuli, redstone)</li>
<li>Deepslate Tiles blocks, slabs, stairs, and walls</li>
<li>Flowering Azalea Leaves</li>
<li>Froglight (pearlescent, verdant, ochre)</li>
<li>Gilded Blackstone</li>
<li>Glow Item Frame</li>
<li>Hanging Roots</li>
<li>Honeycomb Block</li>
<li>Light Block</li>
<li>Lightning Rod</li>
<li>Mangrove Leaves</li>
<li>Mangrove Roots</li>
<li>Mangrove buttons, doors, fences, fence gates, logs, planks, pressure plates, signs, slabs, stairs, trapdoors, and wood</li>
<li>Mud Bricks blocks, slabs, stairs, and walls</li>
<li>Muddy Mangrove Roots</li>
<li>Nether Gold Ore</li>
<li>Netherite Block</li>
<li>Polished Basalt</li>
<li>Polished Blackstone Bricks blocks, slabs, stairs, and walls</li>
<li>Polished Blackstone blocks, buttons, pressure plates, slabs, stairs, and walls</li>
<li>Polished Deepslate blocks, slabs, stairs, and walls</li>
<li>Quartz Bricks</li>
<li>Reinforced Deepslate</li>
<li>Rooted Dirt</li>
<li>Sculk</li>
<li>Shroomlight</li>
<li>Smithing Table</li>
<li>Smooth Basalt</li>
<li>Soul Fire</li>
<li>Soul Lantern</li>
<li>Soul Soil</li>
<li>Soul Torch</li>
<li>Spore Blossom</li>
<li>Tinted Glass</li>
<li>Tuff</li>
<li>Twisting Vines</li>
<li>Warped Wart Block</li>
<li>Warped buttons, doors, fences, fence gates, hyphae, planks, pressure plates, signs, slabs, stairs, stems, and trapdoors</li>
<li>Weeping Vines</li>
<li>Wither Rose</li>
</ul>
</li>
<li>Added support for basalt generators</li>
<li>Added support for dyeing sign text and making it glow.</li>
<li>All-sided logs ("wood", for want of a better name) can now be placed in X, Y, and Z orientations.</li>
<li>Coral and coral fans now behave correctly when placed out of water (they no longer immediately die).</li>
<li>Fixed dead bush being able <a class="el" href="protocolto-p.html">to</a> be placed on some invalid blocks (e.g. stone).</li>
<li>Fixed lava setting entities on fire for an incorrect duration (Java vs Bedrock inconsistency).</li>
<li>Fixed sugarcane not being able <a class="el" href="protocolto-p.html">to</a> be placed on some blocks.</li>
<li>Iron Ore and Gold Ore now drop Raw Iron and Raw Gold respectively, instead of the ore blocks.</li>
<li>Item frames can now be placed on the top and bottom of blocks.</li>
<li>Stripping logs by right-clicking them with an axe is now supported.</li>
<li>TNT can now be ignited by fire charges.</li>
<li>Vines can now only be placed on the side of full-cube blocks.</li>
<li>Walls now connect when placed, following the pre-1.16 logic. (1.16 logic is planned <a class="el" href="protocolto-p.html">to</a> be implemented, but currently low priority.)</li>
<li>Anvils are now damaged when they hit the ground after falling.</li>
<li>Added missing sounds for anvils hitting the ground after falling.</li>
<li>Anvils now damage entities when they fall on top of them.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1513"></a>
Items</h2>
<ul>
<li>Added the following new items:<ul>
<li>Amethyst Shard</li>
<li>Antidote (from Education Edition)</li>
<li>Copper Ingot</li>
<li>Disc Fragment (5)</li>
<li>Echo Shard</li>
<li>Elixir (from Education Edition)</li>
<li>Eye Drops (from Education Edition)</li>
<li>Fire Charge</li>
<li>Glow Berries</li>
<li>Glow Ink Sac</li>
<li>Honey Bottle</li>
<li>Honeycomb</li>
<li>Mangrove Boat (incomplete)</li>
<li>Music Disc (5)</li>
<li>Music Disc (Otherside)</li>
<li>Music Disc (Pigstep)</li>
<li>Netherite Axe</li>
<li>Netherite Boots</li>
<li>Netherite Chestplate</li>
<li>Netherite Helmet</li>
<li>Netherite Ingot</li>
<li>Netherite Leggings</li>
<li>Netherite Pickaxe</li>
<li>Netherite Scrap</li>
<li>Netherite Shovel</li>
<li>Netherite Sword</li>
<li>Phantom Membrane</li>
<li>Raw Copper</li>
<li>Raw Gold</li>
<li>Raw Iron</li>
<li>Spyglass</li>
<li>Suspicious Stew</li>
<li>Tonic (from Education Edition)</li>
</ul>
</li>
<li>Glass bottles can now be filled with water by clicking on a water source block.</li>
<li>Implemented Swift Sneak enchantment.</li>
<li>Armour durability is now only reduced when the wearer receives a type of damage that the armour can protect against.</li>
<li>Bells now ring when hit by a projectile.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1514"></a>
Worlds</h2>
<ul>
<li>World height of -64 <a class="el" href="protocolto-p.html">to</a> 319 is now supported.</li>
<li>Added support for 3D biomes. This isn't used by PocketMine-MP yet, but is necessary <a class="el" href="protocolto-p.html">to</a> be able <a class="el" href="protocolto-p.html">to</a> fully load 1.18 worlds.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1515"></a>
API</h1>
<h2><a class="anchor" id="autotoc_md1516"></a>
General</h2>
<ul>
<li>Union and mixed native parameter, return and property types are now used where appropriate.</li>
<li>Protected and public properties now use native property types wherever possible.</li>
<li>Parameter and return typehints have been applied in many places where it wasn't previously possible.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1517"></a>
Dependencies</h2>
<ul>
<li><a href="https://github.com/pmmp/ext-pmmpthread/releases/6.0.0"><code>ext-pmmpthread</code> version 6.0.0</a> (renamed from <code>ext-pthreads</code>) is now required. This version features major API changes and improvements. Please read the <a href="https://github.com/pmmp/ext-pmmpthread/blob/fork/docs/UPGRADING_4.x_to_6.0.md">upgrading guide</a> for details.</li>
<li><a href="https://github.com/pmmp/Snooze/releases/0.5.0"><code>pocketmine/snooze</code> version 0.5.0</a> is now required.</li>
<li><a href="https://github.com/pmmp/RakLib/releases/0.15.0"><code>pocketmine/raklib</code> version 0.15.0</a> is now required.</li>
<li><a href="https://github.com/pmmp/RakLibIpc/releases/0.2.0"><code>pocketmine/raklib-ipc</code> version 0.2.0</a> is now required.</li>
<li><code>pocketmine/classloader</code> and <code>pocketmine/log-pthreads</code> packages have been removed. The relevant classes from these packages are now included in-house in the <code>pocketmine/thread</code> namespace.<ul>
<li><code>BaseClassLoader</code> is replaced with <code>pocketmine\thread\ThreadSafeClassLoader</code></li>
<li><code>ThreadedLogger</code> is replaced by <code>pocketmine\thread\ThreadSafeLogger</code></li>
<li><code>AttachableThreadedLogger</code> is replaced by <code>pocketmine\thread\AttachableThreadSafeLogger</code></li>
<li><code>ThreadedLoggerAttachment</code> is replaced by <code>pocketmine\thread\ThreadSafeLoggerAttachment</code></li>
</ul>
</li>
<li><code>webmozart/path-util</code> has been removed (replaced by <a href="https://github.com/symfony/filesystem"><code>symfony/filesystem</code></a>).</li>
</ul>
<h2><a class="anchor" id="autotoc_md1518"></a>
&lt;tt&gt;pocketmine\block&lt;/tt&gt;</h2>
<h3><a class="anchor" id="autotoc_md1519"></a>
Highlights</h3>
<ul>
<li>Blocks no longer use internal Minecraft IDs and metadata <a class="el" href="protocolto-p.html">to</a> identify themselves. All APIs associated with legacy IDs and meta have been removed.</li>
<li>A new set of runtime IDs generated from <code>VanillaBlocks</code> is used <a class="el" href="protocolto-p.html">to</a> identify block types. These IDs are defined in <code>BlockTypeIds</code>.<ul>
<li>These new IDs are used for runtime representation of blocks on chunks, and for type comparison purposes.</li>
<li>Block type IDs are used at <b>runtime only</b>. <b>Do not store them in configs or databases</b>, as they are subject <a class="el" href="protocolto-p.html">to</a> change without warning.</li>
<li>Block type IDs are <b>specific <a class="el" href="protocolto-p.html">to</a> PocketMine-MP</b> and have no relation <a class="el" href="protocolto-p.html">to</a> the IDs used by Minecraft.</li>
<li>Block type IDs cannot be negative</li>
<li>Block type IDs must not be reused, even if overriding an already defined block</li>
</ul>
</li>
<li>Block state properties (e.g. facing, colour, etc.) are now represented by PM-specific state data instead of legacy metadata. The state data consists of:<ul>
<li>Block-item state properties - retained by items when the block is broken (colour, wet/dry, coral type, etc.) - handled by <code>Block-&gt;describeBlockItemState()</code></li>
<li>Block-only state data - discarded when the block is broken (facing direction, lit/unlit, powered/unpowered, etc.) - handled by <code>Block-&gt;describeBlockOnlyState()</code></li>
</ul>
</li>
<li>Chunks now store dynamic state ID derived from the runtime type ID and runtime (PocketMine-MP defined) state data.</li>
<li>Introduced "type tags" concept, which allows marking certain blocks as having certain behaviours.<ul>
<li>The idea for this system was borrowed from the Minecraft Java tags system.</li>
<li>It's still in very early concept stage, but is currently used for deciding which types of blocks plants can be placed on without needing <a class="el" href="protocolto-p.html">to</a> enumerate every single ID in every class, eliminating a bunch of boilerplate code and improving consistency.</li>
</ul>
</li>
<li>All <code>Block</code> descendents now accept <code>BlockTypeInfo</code> in the constructor, instead of <code>BlockBreakInfo</code>. This allows for future additions without needing <a class="el" href="protocolto-p.html">to</a> change dozens of overridden constructors.</li>
<li><code>&amp;$returnedItems</code> reference parameter is now used in some places such as <code>Block-&gt;onInteract()</code> <a class="el" href="protocolto-p.html">to</a> enable actions <a class="el" href="protocolto-p.html">to</a> return items <a class="el" href="protocolto-p.html">to</a> players without caring about whether they are in creative or anything else.<ul>
<li>This eliminates boilerplate code of deciding whether <a class="el" href="protocolto-p.html">to</a> set the player's held item or not, as well as automatically dropping any overflow items that don't fit into the inventory.</li>
<li>This is currently used when filling/emptying cauldrons using buckets or glass bottles.</li>
</ul>
</li>
<li>Dependency between <code>RuntimeBlockStateRegistry</code> (previously <code>BlockFactory</code>) and <code>VanillaBlocks</code> has been inverted.<ul>
<li>Now, blocks types are defined in <code>VanillaBlocks</code></li>
<li><code>RuntimeBlockStateRegistry</code> automatically registers states for blocks defined in <code>VanillaBlocks</code>.</li>
<li>Manual registration in <code>RuntimeBlockStateRegistry</code> is still required for custom blocks (see section below about registering new blocks).</li>
</ul>
</li>
<li><code>RuntimeBlockStateRegistry</code> now has only one purpose - <a class="el" href="protocolto-p.html">to</a> map internal blockstate IDs <a class="el" href="protocolto-p.html">to</a> <code>Block</code> objects when reading blocks from chunks. It should not be used by plugins unless registering new blocks.<ul>
<li>To get a block at runtime, e.g. stone, use <code>VanillaBlocks::STONE()</code></li>
<li>To load a block from <b>old</b> config or database data:<ol type="1">
<li>Use <code>GlobalBlockStateHandlers::getUpgrader()-&gt;upgradeIntIdMeta()</code> <a class="el" href="protocolto-p.html">to</a> convert it <a class="el" href="protocolto-p.html">to</a> modern data</li>
<li>Pass the data <a class="el" href="protocolto-p.html">to</a> <code>GlobalBlockStateHandlers::getDeserializer()</code> <a class="el" href="protocolto-p.html">to</a> get a blockstate ID</li>
<li>Pass the blockstate ID <a class="el" href="protocolto-p.html">to</a> <code>RuntimeBlockStateRegistry::fromStateId()</code> <a class="el" href="protocolto-p.html">to</a> get a <code>Block</code> instance</li>
</ol>
</li>
<li>Prefer using <code>StringToItemParser</code> wherever possible for configs and databases (see <code>lookupAliases()</code> and <code>lookupBlockAliases()</code>).</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md1520"></a>
Registering new blocks</h3>
<h4><a class="anchor" id="autotoc_md1521"></a>
In a plugin</h4>
<p>To add a vanilla block in a plugin which isn't yet supported by PocketMine-MP, do the following:</p>
<ol type="1">
<li>Get a new type ID using <code>BlockTypeIds::newId()</code> - <em>you'll want <a class="el" href="protocolto-p.html">to</a> keep this in a property somewhere if you want <a class="el" href="protocolto-p.html">to</a> compare using <code>getTypeId()</code> later</em></li>
<li>Set up the block type somewhere - <em>this can be anywhere you like, e.g. a plugin main class property, but using a <code>RegistryTrait</code> class is recommended - you'll need this later <a class="el" href="protocolto-p.html">to</a> create new instances of the block</em></li>
<li>Register the block in <code>RuntimeBlockStateRegistry</code> - <em>this informs the server of all the block's possible states so that it can be read from chunks at runtime</em></li>
<li>Register a deserializer for the block's Minecraft ID in <code>BlockStateToObjectDeserializer</code> - <em>needed for the block <a class="el" href="protocolto-p.html">to</a> be recognized when loaded from disk</em></li>
<li>Register a serializer for the block in <code>BlockObjectToStateSerializer</code> - <em>needed for the block <a class="el" href="protocolto-p.html">to</a> be saved <a class="el" href="protocolto-p.html">to</a> disk, and <a class="el" href="protocolto-p.html">to</a> be sent over the network</em></li>
<li>Optionally, register a string alias for the block in <code>StringToItemParser</code> - <em>so that it can be given via <code>/give</code></em></li>
</ol>
<p>To see a demo of how <a class="el" href="protocolto-p.html">to</a> do this in a plugin, see <a href="https://github.com/pmmp/RegisterBlocksDemoPM5">this example plugin</a>.</p>
<p>Registering custom blocks follows a similar process, but requires additional steps <a class="el" href="protocolto-p.html">to</a> modify <code>BlockStateDictionary</code> which won't be covered here. Since this is not currently officially supported by PocketMine-MP, this won't be covered here.</p>
<p>This is admittedly rather more of a hassle than in PM4, but this system offers significantly more flexibility than the old system.</p>
<h4><a class="anchor" id="autotoc_md1522"></a>
As a PocketMine-MP core contribution</h4>
<p>To register a new vanilla block into the core, the process is slightly different:</p>
<ol type="1">
<li>Instead of using <code>BlockTypeIds::newId()</code>, add a new constant for the block <a class="el" href="protocolto-p.html">to</a> <code>BlockTypeIds</code></li>
<li>Register the new block in <code>VanillaBlocks</code> - <code>RuntimeBlockStateRegistry</code> will automagically take notice of all blocks defined in <code>VanillaBlocks</code></li>
<li>Follow steps 4 onwards above</li>
</ol>
<h3><a class="anchor" id="autotoc_md1523"></a>
Change list</h3>
<ul>
<li>The following classes have been removed:<ul>
<li><code>BlockIdentifierFlattened</code></li>
<li><code>BlockLegacyIdHelper</code></li>
<li><code>BlockLegacyIds</code></li>
<li><code>BlockLegacyMetadata</code></li>
<li><code>utils\BlockDataSerializer</code></li>
<li><code>utils\ColorInMetadataTrait</code> - <code>utils\ColoredTrait</code> now implements colour type data serialization uniformly</li>
<li><code>utils\InvalidBlockStateException</code> - this has been superseded by <code>pocketmine\data\runtime\InvalidSerializedRuntimeDataException</code></li>
<li><code>utils\NormalHorizontalFacingInMetadataTrait</code> - <code>utils\HorizontalFacingTrait</code> now implements facing type data serialization uniformly</li>
<li><code>utils\PillarRotationInMetadataTrait</code> - <code>utils\PillarRotationTrait</code> now implements rotation type data serialization uniformly</li>
</ul>
</li>
<li>The following classes have been renamed:<ul>
<li><code>BlockFactory</code> -&gt; <code>RuntimeBlockStateRegistry</code> - this class is now exclusively used for mapping state IDs <a class="el" href="protocolto-p.html">to</a> block instances for runtime chunk block reading</li>
<li><code>Skull</code> -&gt; <code>MobHead</code></li>
<li><code>utils\SkullType</code> -&gt; <code>utils\MobHeadType</code></li>
<li><code>utils\TreeType</code> -&gt; <code>pocketmine\world\generator\object\TreeType</code></li>
</ul>
</li>
<li>The following classes have been added:<ul>
<li><code>BaseCake</code></li>
<li><code>BaseFire</code></li>
<li><code>BlockTypeIds</code> - list of type IDs, one for each entry in <code>VanillaBlocks</code></li>
<li><code>BlockTypeInfo</code></li>
<li><code>BlockTypeTags</code></li>
<li><code>CakeWithCandle</code></li>
<li><code>CakeWithDyedCandle</code></li>
<li><code>Candle</code></li>
<li><code>CartographyTable</code></li>
<li><code>Chain</code></li>
<li><code>CopperOre</code></li>
<li><code>CopperSlab</code></li>
<li><code>CopperStairs</code></li>
<li><code>Copper</code></li>
<li><code>DyedCandle</code></li>
<li><code>GildedBlackstone</code></li>
<li><code>GoldOre</code></li>
<li><code>HangingRoots</code></li>
<li><code>IronOre</code></li>
<li><code>Light</code></li>
<li><code>LightningRod</code></li>
<li><code>NetherGoldOre</code></li>
<li><code>Sculk</code></li>
<li><code>SmithingTable</code></li>
<li><code>SoulFire</code></li>
<li><code>WitherRose</code></li>
<li><code>utils\CandleTrait</code></li>
<li><code>utils\CopperOxidation</code></li>
<li><code>utils\CopperTrait</code></li>
<li><code>utils\SaplingType</code> - enum of all sapling types</li>
<li><code>utils\WallConnectionType</code> - enum of all possible wall connection types</li>
<li><code>utils\WoodTypeTrait</code></li>
<li><code>utils\WoodType</code> - enum of all possible wood types, used for wood material blocks like planks and logs</li>
</ul>
</li>
<li>The following API methods have been removed:<ul>
<li><code>Block-&gt;getId()</code> - for type comparisons, use <code>Block-&gt;getTypeId()</code> instead</li>
<li><code>Block-&gt;getMeta()</code> - for state comparisons, use <code>Block-&gt;getStateId()</code> instead</li>
<li><code>Block-&gt;getStateBitmask()</code></li>
<li><code>Block-&gt;readStateFromData()</code></li>
<li><code>Block-&gt;writeStateToItemMeta()</code></li>
<li><code>Block-&gt;writeStateToMeta()</code></li>
<li><code>BlockFactory-&gt;get()</code> - see notes above about <code>RuntimeBlockStateRegistry</code></li>
<li><code>BlockIdentifier-&gt;getAllBlockIds()</code></li>
<li><code>BlockIdentifier-&gt;getBlockId()</code></li>
<li><code>BlockIdentifier-&gt;getItemId()</code></li>
<li><code>BlockIdentifier-&gt;getVariant()</code></li>
<li><code>Door-&gt;isPowered()</code></li>
<li><code>Door-&gt;setPowered()</code></li>
<li><code>MobHead-&gt;isNoDrops()</code> (previously <code>Skull-&gt;isNoDrops()</code>)</li>
<li><code>MobHead-&gt;setNoDrops()</code> (previously <code>Skull-&gt;setNoDrops()</code>)</li>
<li><code>VanillaBlocks::*_GLAZED_TERRACOTTA()</code> - use <code>VanillaBlocks::GLAZED_TERRACOTTA()-&gt;setColor(DyeColor::WHATEVER())</code> instead</li>
<li><code>utils\FallableTrait-&gt;getId()</code> is no longer required</li>
<li><code>utils\FallableTrait-&gt;getMeta()</code> is no longer required</li>
<li><code>utils\MobHeadType-&gt;getMagicNumber()</code> (previously <code>utils\SkullType-&gt;getMagicNumber()</code>)</li>
<li><code>utils\MobHeadType::fromMagicNumber()</code> (previously <code>utils\SkullType::fromMagicNumber()</code>)</li>
</ul>
</li>
<li>The following constants have been removed:<ul>
<li><code>Block::INTERNAL_METADATA_BITS</code></li>
<li><code>Block::INTERNAL_METADATA_MASK</code></li>
</ul>
</li>
<li>The following API methods have been renamed:<ul>
<li><code>Block-&gt;getFullId()</code> -&gt; <code>Block-&gt;getStateId()</code></li>
<li><code>Block-&gt;isSameType()</code> -&gt; <code>Block-&gt;hasSameTypeId()</code></li>
<li><code>MobHead-&gt;getSkullType()</code> -&gt; <code>MobHead-&gt;getMobHeadType()</code> (previously <code>Skull-&gt;getSkullType()</code>)</li>
<li><code>MobHead-&gt;setSkullType()</code> -&gt; <code>MobHead-&gt;setMobHeadType()</code> (previously <code>Skull-&gt;setSkullType()</code>)</li>
</ul>
</li>
<li>The following API methods have signature changes:<ul>
<li><code>Block-&gt;onBreak()</code> now accepts <code>array&lt;Item&gt; &amp;$returnedItems</code> reference parameter.</li>
<li><code>Block-&gt;onInteract()</code> now accepts <code>array&lt;Item&gt; &amp;$returnedItems</code> reference parameter.</li>
<li><code>Block-&gt;readStateFromWorld()</code> now returns <code>Block</code> - this allows blocks <a class="el" href="protocolto-p.html">to</a> replace themselves with a different block entirely based on world conditions.</li>
<li><code>BlockIdentifier-&gt;__construct()</code> now accepts <code>int $blockTypeId</code>, and no longer accepts <code>int $blockId, int $variant, ?int $itemId</code></li>
<li><code>ItemFrame-&gt;getFacing()</code> may now return <code>Facing::UP</code> and <code>Facing::DOWN</code></li>
<li><code>ItemFrame-&gt;setFacing()</code> now accepts <code>Facing::UP</code> and <code>Facing::DOWN</code></li>
<li><code>Leaves-&gt;__construct()</code> now accepts <code>LeavesType $leavesType</code> instead of <code>TreeType $treeType</code></li>
<li><code>RuntimeBlockStateRegistry-&gt;register()</code> no longer accepts an <code>$override</code> parameter.</li>
<li><code>Sapling::__construct()</code> now accepts <code>SaplingType $saplingType</code> instead of <code>TreeType $treeType</code></li>
<li><code>utils\SignText::__construct()</code> now accepts two new optional parameters: <code>?Color $baseColor</code> and <code>bool $glowing</code></li>
<li><code>utils\SignText::fromBlob()</code> now accepts two new optional parameters: <code>?Color $baseColor</code> and <code>bool $glowing</code></li>
</ul>
</li>
<li>The following API methods have been added:<ul>
<li><code>protected Block-&gt;describeBlockOnlyState(RuntimeDataDescriber $w) : void</code> - describes state properties which are discarded when the block is broken or block-picked, such as facing, powered, etc.</li>
<li><code>public Block-&gt;describeBlockItemState(RuntimeDataDescriber $w) : void</code> - describes state properties which are kept by the item when the block is broken or block-picked, such as dye color</li>
<li><code>public Block-&gt;generateStatePermutations() : \Generator&lt;int, Block, void, void&gt;</code> - yields all possible states this block type can be in (used for <code>RuntimeBlockStateRegistry</code>)</li>
<li><code>public Block-&gt;getTypeTags() : array&lt;string&gt;</code></li>
<li><code>public Block-&gt;hasTypeTag(string $tag) : bool</code></li>
<li><code>public Block-&gt;isFireProofAsItem() : bool</code></li>
<li><code>public Block-&gt;onProjectileHit(Projectile $projectile, RayTraceResult $hitResult) : void</code></li>
<li><code>public BlockIdentifier-&gt;getBlockTypeId() : int</code> - returns the block's type ID according <a class="el" href="protocolto-p.html">to</a> <code>BlockTypeIds</code></li>
<li><code>public Furnace-&gt;getFurnaceType() : utils\FurnaceType</code></li>
<li><code>public GlazedTerracotta-&gt;getColor() : utils\DyeColor</code> (from <code>ColoredTrait</code>) - this was previously unsupported due <a class="el" href="protocolto-p.html">to</a> legacy limitations</li>
<li><code>public GlazedTerracotta-&gt;setColor(utils\DyeColor $color) : $this</code> (from <code>ColoredTrait</code>) - this was previously unsupported due <a class="el" href="protocolto-p.html">to</a> legacy limitations</li>
<li><code>public Leaves-&gt;getLeavesType() : utils\LeavesType</code> - returns the type of leaves</li>
<li><code>public Wall-&gt;getConnection(int $face) : utils\WallConnectionType</code></li>
<li><code>public Wall-&gt;getConnections() : array&lt;int, utils\WallConnectionType&gt;</code> - returns the wall's connections and their types (see <code>utils\WallConnectionType</code>)</li>
<li><code>public Wall-&gt;isPost() : bool</code></li>
<li><code>public Wall-&gt;setConnection(int $face, ?utils\WallConnectionType $type) : $this</code></li>
<li><code>public Wall-&gt;setConnections()</code> - sets the wall's connections and their types (see <code>utils\WallConnectionType</code>)</li>
<li><code>public Wall-&gt;setPost(bool $post) : $this</code></li>
<li><code>public Wood-&gt;isStripped() : bool</code></li>
<li><code>public Wood-&gt;setStripped(bool $stripped) : $this</code></li>
<li><code>public static BlockBreakInfo::axe(float $hardness, ?ToolTier $toolTier = null, ?float $blastResistance = null) : BlockBreakInfo</code></li>
<li><code>public static BlockBreakInfo::pickaxe(float $hardness, ?ToolTier $toolTier = null, ?float $blastResistance = null) : BlockBreakInfo</code></li>
<li><code>public static BlockBreakInfo::shovel(float $hardness, ?ToolTier $toolTier = null, ?float $blastResistance = null) : BlockBreakInfo</code></li>
<li><code>public static BlockBreakInfo::tier(float $hardness, int $toolType, ToolTier $toolTier, ?float $blastResistance = null) : BlockBreakInfo</code></li>
<li><code>public tile\Spawnable-&gt;getRenderUpdateBugWorkaroundStateProperties(Block $block) : array&lt;string, Tag&gt;</code> - allows spawnable tiles <a class="el" href="protocolto-p.html">to</a> spoof block state properties <a class="el" href="protocolto-p.html">to</a> work around client-side rendering bugs without actually changing the block server-side</li>
<li><code>public utils\SignText-&gt;getBaseColor() : \pocketmine\color\Color</code></li>
<li><code>public utils\SignText-&gt;isGlowing() : bool</code></li>
</ul>
</li>
<li>The following classes now use new traits, adding API methods and/or properties:<ul>
<li><code>FenceGate</code> uses <code>utils\WoodTypeTrait</code></li>
<li><code>GlazedTerracotta</code> uses <code>utils\ColoredTrait</code></li>
<li><code>Planks</code> uses <code>utils\WoodTypeTrait</code></li>
<li><code>Wood</code> uses <code>utils\WoodTypeTrait</code></li>
<li><code>WoodenButton</code> uses <code>utils\WoodTypeTrait</code></li>
<li><code>WoodenDoor</code> uses <code>utils\WoodTypeTrait</code></li>
<li><code>WoodenFence</code> uses <code>utils\WoodTypeTrait</code></li>
<li><code>WoodenPressurePlate</code> uses <code>utils\WoodTypeTrait</code></li>
<li><code>WoodenSlab</code> uses <code>utils\WoodTypeTrait</code></li>
<li><code>WoodenStairs</code> uses <code>utils\WoodTypeTrait</code></li>
<li><code>WoodenTrapdoor</code> uses <code>utils\WoodTypeTrait</code></li>
</ul>
</li>
<li>The following API interface requirements have been added (BC breaking):<ul>
<li><code>public utils\Fallable-&gt;getFallDamagePerBlock() : float</code> (default implementation provided by <code>utils\FallableTrait</code>)</li>
<li><code>public utils\Fallable-&gt;getLandSound() : ?Sound</code> (default implementation provided by <code>utils\FallableTrait</code>)</li>
<li><code>public utils\Fallable-&gt;getMaxFallDamage() : float</code> (default implementation provided by <code>utils\FallableTrait</code>)</li>
<li><code>public utils\Fallable-&gt;onHitGround(FallingBlock $blockEntity) : bool</code> (default implementation provided by <code>utils\FallableTrait</code>)</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1524"></a>
&lt;tt&gt;pocketmine\command&lt;/tt&gt;</h2>
<ul>
<li>Command permissions are now always checked by the server when running a command.<ul>
<li>This only affects commands implemented by extending <code>Command</code>. Plugins using <code>PluginBase-&gt;onCommand()</code> are not affected by this change, since they already had permissions checked by the server anyway.</li>
<li>Previously, direct inheritors of <code>Command</code> were responsible for checking permissions, which required developers <a class="el" href="protocolto-p.html">to</a> duplicate the same code in every command, and opened lots of potential for security vulnerabilities.</li>
<li>If you want <a class="el" href="protocolto-p.html">to</a> do something on permission denied (e.g. sending a special message, or audit logging), you can do so by overriding <code>Command-&gt;testPermission()</code>, instead of baking the code directly into <code>Command-&gt;execute()</code>.</li>
<li>If you don't want <a class="el" href="protocolto-p.html">to</a> use permissions at all, just create a permission with a default of <code>true</code> (or belonging <a class="el" href="protocolto-p.html">to</a> <code>pocketmine.group.user</code>) and assign that.</li>
</ul>
</li>
<li><code>SimpleCommandMap</code> now requires all commands <a class="el" href="protocolto-p.html">to</a> have a permission set when registered.<ul>
<li>If you actually want <a class="el" href="protocolto-p.html">to</a> allow everyone <a class="el" href="protocolto-p.html">to</a> use your command (not advised), you can add a new permission <a class="el" href="protocolto-p.html">to</a> the <code>pocketmine.group.user</code> group, or use <code>default: true</code> for <code>plugin.yml</code> permissions.</li>
</ul>
</li>
<li>The following API methods have changed behaviour:<ul>
<li><code>Command-&gt;testPermissionSilent()</code> now returns <code>false</code> if there are no permissions associated with the command. This is <a class="el" href="protocolto-p.html">to</a> prevent commands with no permissions being usable by everyone, which has previously been a source of security issues.</li>
</ul>
</li>
<li>The following API methods have been added:<ul>
<li><code>public Command-&gt;getPermissions() : list&lt;string&gt;</code> - returns a list of permissions which grant usage access <a class="el" href="protocolto-p.html">to</a> this command. A user with one or more of these permissions will be able <a class="el" href="protocolto-p.html">to</a> invoke the command's <code>execute()</code> method</li>
<li><code>public Command-&gt;setPermissions(list&lt;string&gt; $permissions) : void</code> - sets the permissions which grant usage access <a class="el" href="protocolto-p.html">to</a> this command. This should be used instead of <code>setPermission()</code> with <code>;</code> separators (which is now deprecated)</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1525"></a>
&lt;tt&gt;pocketmine\crafting&lt;/tt&gt;</h2>
<ul>
<li>JSON models have been updated <a class="el" href="protocolto-p.html">to</a> reflect updated crafting data format.</li>
<li>The following enum classes have new members:<ul>
<li><code>ShapelessRecipeType</code> has new members <code>CARTOGRAPHY</code> and <code>SMITHING</code></li>
</ul>
</li>
<li>The following classes have been added:<ul>
<li><code>ExactRecipeIngredient</code> - matches an exact item</li>
<li><code>MetaWildcardRecipeIngredient</code> - matches an item with the given legacy Minecraft ID, but any metadata value</li>
<li><code>RecipeIngredient</code> interface</li>
<li><code>TagWildcardRecipeIngredient</code> - matches an item based on its Minecraft tags, e.g. <code>minecraft:wooden_tier</code></li>
</ul>
</li>
<li>The following API methods have signature changes:<ul>
<li><code>FurnaceRecipe-&gt;__construct()</code> now accepts <code>RecipeIngredient</code> instead of <code>Item</code></li>
<li><code>FurnaceRecipe-&gt;getInput()</code> now returns <code>RecipeIngredient</code> instead of <code>Item</code></li>
<li><code>PotionContainerChangeRecipe-&gt;__construct()</code> now accepts <code>string, RecipeIngredient, string</code> (using Minecraft string IDs instead of legacy integers).</li>
<li><code>PotionContainerChangeRecipe-&gt;getIngredient()</code> now returns <code>RecipeIngredient</code> instead of <code>Item</code>.</li>
<li><code>PotionContainerChangeRecipe-&gt;getInputItemId()</code> now returns <code>string</code> (using Minecraft string IDs instead of legacy integers).</li>
<li><code>PotionContainerChangeRecipe-&gt;getOutputItemId()</code> now returns <code>string</code> (using Minecraft string IDs instead of legacy integers).</li>
<li><code>PotionTypeRecipe-&gt;__construct()</code> now accepts <code>RecipeIngredient</code> instead of <code>Item</code></li>
<li><code>PotionTypeRecipe-&gt;getIngredient()</code> now returns <code>RecipeIngredient</code> instead of <code>Item</code></li>
<li><code>PotionTypeRecipe-&gt;getInput()</code> now returns <code>RecipeIngredient</code> instead of <code>Item</code></li>
<li><code>ShapedRecipe-&gt;__construct()</code> now accepts <code>RecipeIngredient</code> instead of <code>Item</code></li>
<li><code>ShapedRecipe-&gt;getIngredient()</code> now returns <code>?RecipeIngredient</code> instead of <code>?Item</code></li>
<li><code>ShapedRecipe-&gt;getIngredientList()</code> now returns <code>RecipeIngredient[]</code> instead of <code>Item[]</code></li>
<li><code>ShapedRecipe-&gt;getIngredientMap()</code> now returns <code>RecipeIngredient[][]</code> instead of <code>Item[][]</code></li>
<li><code>ShapelessRecipe-&gt;__construct()</code> <code>$type</code> parameter is now mandatory.</li>
<li><code>ShapelessRecipe-&gt;__construct()</code> now accepts <code>RecipeIngredient</code> instead of <code>Item</code></li>
<li><code>ShapelessRecipe-&gt;getIngredientList()</code> now returns <code>RecipeIngredient[]</code> instead of <code>Item[]</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1526"></a>
&lt;tt&gt;pocketmine\data&lt;/tt&gt;</h2>
<ul>
<li>New packages <code>bedrock\block</code> and <code>bedrock\item</code> have been added. These packages contain all the necessary code for loading and saving Bedrock blocks and items from disk.</li>
<li>New package <code>runtime</code> has been added. This package contains code for serializing runtime data for blocks and items.</li>
<li><code>LegacyToStringBidirectionalIdMap</code> has been reduced <a class="el" href="protocolto-p.html">to</a> <code>LegacyToStringIdMap</code>.<ul>
<li>Since we never map from string ID <a class="el" href="protocolto-p.html">to</a> legacy ID, bidirectional mapping is no longer necessary.</li>
<li>This affects the following subclasses:<ul>
<li><code>LegacyBiomeIdToStringIdMap</code></li>
<li><code>LegacyBlockIdToStringIdMap</code></li>
<li><code>LegacyEntityIdToStringIdMap</code></li>
<li><code>LegacyItemIdToStringIdMap</code></li>
</ul>
</li>
</ul>
</li>
<li>The following internal API methods have been added:<ul>
<li><code>public LegacyToStringIdMap-&gt;add(string $string, int $legacy) : void</code> - adds a mapping from a custom legacy ID <a class="el" href="protocolto-p.html">to</a> custom string ID, needed for upgrading old saved data</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1527"></a>
&lt;tt&gt;pocketmine\entity&lt;/tt&gt;</h2>
<ul>
<li><code>Entity</code> now declares new abstract methods which must be implemented by subclasses:<ul>
<li><code>public Entity-&gt;getInitialDragMultiplier() : float</code></li>
<li><code>public Entity-&gt;getInitialGravity() : float</code></li>
</ul>
</li>
<li>The following new API methods have been added:<ul>
<li><code>public Living-&gt;getDisplayName() : string</code></li>
</ul>
</li>
<li>The following API methods have changed signatures:<ul>
<li><code>EntityFactory-&gt;register()</code> no longer accepts a <code>$legacyMcpeSaveId</code> parameter (now handled by internal conversions instead).</li>
</ul>
</li>
<li>The following API methods have been renamed:<ul>
<li><code>Entity-&gt;isImmobile()</code> -&gt; <code>Entity-&gt;hasNoClientPredictions()</code></li>
<li><code>Entity-&gt;setImmobile()</code> -&gt; <code>Entity-&gt;setNoClientPredictions()</code></li>
</ul>
</li>
<li>The following internal fields have been renamed:<ul>
<li><code>Entity-&gt;immobile</code> -&gt; <code>Entity-&gt;noClientPredictions</code></li>
</ul>
</li>
<li>The following classes have been removed:<ul>
<li><code>EntityLegacyIds</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1528"></a>
&lt;tt&gt;pocketmine\event&lt;/tt&gt;</h2>
<ul>
<li>The following classes have inheritance changes:<ul>
<li><code>block\BlockPlaceEvent</code> no longer extends <code>BlockEvent</code>, and therefore no longer has <code>getBlock()</code>. Use <code>getTransaction()</code> instead (may contain multiple blocks).</li>
</ul>
</li>
<li><code>BlockFormEvent</code> now includes information about the block which caused the event.</li>
<li>The following new classes have been added:<ul>
<li><code>world\WorldDisplayNameChangeEvent</code> - called when a world's display name is changed</li>
</ul>
</li>
<li>The following classes have been renamed:<ul>
<li><code>entity\ExplosionPrimeEvent</code> -&gt; <code>entity\EntityPreExplodeEvent</code></li>
</ul>
</li>
<li>The following API methods have been added:<ul>
<li><code>public block\BlockFormEvent-&gt;getCausingBlock() : Block</code></li>
<li><code>public block\BlockGrowEvent-&gt;getPlayer() : ?Player</code> - returns the player that triggered the block growth, or <code>null</code> if it was not triggered by a player</li>
<li><code>public block\BlockPlaceEvent-&gt;getTransaction() : BlockTransaction</code> - returns the transaction containing a list of changed block positions and the blockstates they will be changed <a class="el" href="protocolto-p.html">to</a></li>
<li><code>public server\DataPacketSendEvent-&gt;setPackets(list&lt;ClientboundPacket&gt; $packets) : void</code></li>
</ul>
</li>
<li>The following API methods have changed signatures:<ul>
<li><code>block\BlockPlaceEvent-&gt;__construct()</code> now accepts <code>BlockTransaction $transaction</code> instead of <code>Block $blockPlace, Block $blockReplace</code></li>
<li><code>entity\EntityPreExplodeEvent-&gt;__construct()</code> has the <code>$force</code> parameter renamed <a class="el" href="protocolto-p.html">to</a> <code>$radius</code></li>
<li><code>entity\EntityPreExplodeEvent-&gt;getForce() : float</code> -&gt; <code>entity\EntityPreExplodeEvent-&gt;getRadius() : float</code></li>
<li><code>entity\EntityPreExplodeEvent-&gt;setForce(float $force) : void</code> -&gt; <code>entity\EntityPreExplodeEvent-&gt;setRadius(float $radius) : void</code></li>
</ul>
</li>
<li>The following API methods have been removed:<ul>
<li><code>block\BlockPlaceEvent-&gt;getBlockReplaced()</code> - this information is now provided in the <code>BlockTransaction</code> object returned by <code>BlockPlaceEvent-&gt;getTransaction()</code></li>
</ul>
</li>
<li>The following new API constants have been added:<ul>
<li><code>entity\EntityDamageEvent::CAUSE_FALLING_BLOCK</code></li>
<li><code>entity\EntityDamageEvent::MODIFIER_ARMOR_HELMET</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1529"></a>
&lt;tt&gt;pocketmine\event\player&lt;/tt&gt;</h2>
<ul>
<li><code>PlayerPreLoginEvent</code>, <code>PlayerDuplicateLoginEvent</code> and <code>PlayerKickEvent</code> now supports setting separate log reasons (disconnect reason) and disconnect screen messages.</li>
<li>The following classes have been removed:<ul>
<li><code>PlayerCommandPreprocessEvent</code></li>
</ul>
</li>
<li>The following API methods have changed signatures:<ul>
<li><code>PlayerDuplicateLoginEvent-&gt;getDisconnectMessage()</code> now returns <code>Translatable|string</code> instead of <code>string</code></li>
<li><code>PlayerDuplicateLoginEvent-&gt;setDisconnectMessage()</code> now accepts <code>Translatable|string</code> instead of <code>string</code></li>
<li><code>PlayerKickEvent-&gt;getReason()</code> now returns <code>Translatable|string</code> instead of <code>string</code></li>
<li><code>PlayerKickEvent-&gt;setReason()</code> now accepts <code>Translatable|string</code> instead of <code>string</code></li>
<li><code>PlayerLoginEvent-&gt;getKickMessage()</code> now returns <code>Translatable|string</code> instead of <code>string</code></li>
<li><code>PlayerLoginEvent-&gt;setKickMessage()</code> now accepts <code>Translatable|string</code> instead of <code>string</code></li>
<li><code>PlayerPreLoginEvent-&gt;getFinalKickMessage()</code> now returns <code>Translatable|string</code> instead of <code>string</code></li>
<li><code>PlayerPreLoginEvent-&gt;getKickMessage()</code> now returns <code>Translatable|string|null</code> instead of <code>string|null</code></li>
<li><code>PlayerPreLoginEvent-&gt;setKickFlag()</code> (previously <code>setKickReason()</code>) now accepts <code>Translatable|string $disconnectReason, Translatable|string|null $disconnectScreenMessage = null</code> instead of <code>Translatable|string $message</code></li>
<li><code>PlayerPreLoginEvent-&gt;setKickReason()</code> now accepts <code>Translatable|string</code> for the <code>$message</code> parameter instead of <code>string</code></li>
<li><code>PlayerQuitEvent-&gt;getQuitReason()</code> now returns <code>Translatable|string</code> instead of <code>string</code></li>
</ul>
</li>
<li>The following API methods have been removed:<ul>
<li><code>PlayerChatEvent-&gt;getFormat()</code> (use <code>PlayerChatEvent-&gt;getChatFormatter()</code> instead)</li>
<li><code>PlayerChatEvent-&gt;setFormat()</code> (use <code>PlayerChatEvent-&gt;setChatFormatter()</code> instead)</li>
<li><code>PlayerDuplicateLoginEvent-&gt;getDisconnectMessage()</code> - replaced by <code>getDisconnectReason()</code> and <code>getDisconnectScreenMessage()</code></li>
<li><code>PlayerDuplicateLoginEvent-&gt;setDisconnectMessage()</code> - replaced by <code>setDisconnectReason()</code> and <code>setDisconnectScreenMessage()</code></li>
<li><code>PlayerKickEvent-&gt;getReason()</code> - replaced by <code>getDisconnectReason()</code> and <code>getDisconnectScreenMessage()</code></li>
<li><code>PlayerKickEvent-&gt;setReason()</code> - replaced by <code>setDisconnectReason()</code> and <code>setDisconnectScreenMessage()</code></li>
</ul>
</li>
<li>The following new API methods have been added:<ul>
<li><code>public PlayerChatEvent-&gt;getChatFormatter() : \pocketmine\player\chat\ChatFormatter</code> - returns the chat formatter <a class="el" href="protocolto-p.html">to</a> be used for this event</li>
<li><code>public PlayerChatEvent-&gt;setChatFormatter(\pocketmine\player\chat\ChatFormatter $formatter) : void</code> - sets the chat formatter <a class="el" href="protocolto-p.html">to</a> be used for this event</li>
<li><code>public PlayerDeathEvent-&gt;getDeathScreenMessage() : Translatable|string</code> - returns the message <a class="el" href="protocolto-p.html">to</a> be displayed on the death screen</li>
<li><code>public PlayerDeathEvent-&gt;setDeathScreenMessage(Translatable|string $deathScreenMessage) : void</code> - sets the message <a class="el" href="protocolto-p.html">to</a> be displayed on the death screen</li>
<li><code>public PlayerDuplicateLoginEvent-&gt;getDisconnectReason() : Translatable|string</code> - returns the reason for the disconnection displayed in the console and server log</li>
<li><code>public PlayerDuplicateLoginEvent-&gt;getDisconnectScreenMessage() : Translatable|string|null</code> - returns the message <a class="el" href="protocolto-p.html">to</a> be displayed on the disconnect screen (the message in <code>getDisconnectReason()</code> is used if null is returned)</li>
<li><code>public PlayerDuplicateLoginEvent-&gt;setDisconnectReason(Translatable|string $disconnectReason) : void</code> - sets the reason for the disconnection displayed in the console and server log</li>
<li><code>public PlayerDuplicateLoginEvent-&gt;setDisconnectScreenMessage(Translatable|string|null $disconnectScreenMessage) : void</code> - sets the message <a class="el" href="protocolto-p.html">to</a> be displayed on the disconnect screen (the message in <code>setDisconnectReason()</code> is used if null is passed)</li>
<li><code>public PlayerKickEvent-&gt;getDisconnectReason() : Translatable|string</code> - returns the reason for the disconnection displayed in the console and server log</li>
<li><code>public PlayerKickEvent-&gt;getDisconnectScreenMessage() : Translatable|string|null</code> - returns the message <a class="el" href="protocolto-p.html">to</a> be displayed on the disconnect screen (the message in <code>getDisconnectReason()</code> is used if null is returned)</li>
<li><code>public PlayerKickEvent-&gt;setDisconnectReason(Translatable|string $disconnectReason) : void</code> - sets the reason for the disconnection displayed in the console and server log</li>
<li><code>public PlayerKickEvent-&gt;setDisconnectScreenMessage(Translatable|string|null $disconnectScreenMessage) : void</code> - sets the message <a class="el" href="protocolto-p.html">to</a> be displayed on the disconnect screen (the message in <code>setDisconnectReason()</code> is used if null is passed)</li>
<li><code>public PlayerPreLoginEvent-&gt;getDisconnectScreenMessage(int $flag) : Translatable|string|null</code> - returns the message <a class="el" href="protocolto-p.html">to</a> be displayed on the disconnect screen for the specified kick flag, if set</li>
<li><code>public PlayerPreLoginEvent-&gt;getFinalDisconnectScreenMessage() : Translatable|string|null</code> - returns the message <a class="el" href="protocolto-p.html">to</a> be displayed on the disconnect screen, taking into account the kick flags set</li>
</ul>
</li>
<li>The following classes have inheritance changes:<ul>
<li><code>PlayerPreLoginEvent</code> no longer implements <code>Cancellable</code>. This caused unexpected behaviour for most plugin devs due <a class="el" href="protocolto-p.html">to</a> default-ignoring cancelled events, forcing people <a class="el" href="protocolto-p.html">to</a> usually have <a class="el" href="protocolto-p.html">to</a> use <code>@handleCancelled</code> <a class="el" href="protocolto-p.html">to</a> handle the event when they wanted <a class="el" href="protocolto-p.html">to</a> use it.</li>
</ul>
</li>
<li>The following API constants have been renamed:<ul>
<li><code>PlayerPreLoginEvent::KICK_REASON_BANNED</code> -&gt; <code>PlayerPreLoginEvent::KICK_FLAG_BANNED</code></li>
<li><code>PlayerPreLoginEvent::KICK_REASON_PLUGIN</code> -&gt; <code>PlayerPreLoginEvent::KICK_FLAG_PLUGIN</code></li>
<li><code>PlayerPreLoginEvent::KICK_REASON_PRIORITY</code> -&gt; <code>PlayerPreLoginEvent::KICK_FLAG_PRIORITY</code></li>
<li><code>PlayerPreLoginEvent::KICK_REASON_SERVER_FULL</code> -&gt; <code>PlayerPreLoginEvent::KICK_FLAG_SERVER_FULL</code></li>
<li><code>PlayerPreLoginEvent::KICK_REASON_SERVER_WHITELISTED</code> -&gt; <code>PlayerPreLoginEvent::KICK_FLAG_SERVER_WHITELISTED</code></li>
</ul>
</li>
<li>The following API methods have been renamed:<ul>
<li><code>PlayerPreLoginEvent-&gt;clearAllKickReasons()</code> -&gt; <code>PlayerPreLoginEvent-&gt;clearAllKickFlags()</code></li>
<li><code>PlayerPreLoginEvent-&gt;clearKickReason()</code> -&gt; <code>PlayerPreLoginEvent-&gt;clearKickFlag()</code></li>
<li><code>PlayerPreLoginEvent-&gt;getFinalKickMessage()</code> -&gt; <code>PlayerPreLoginEvent-&gt;getFinalDisconnectReason()</code> (now used for logs only, if a disconnect screen message is set for the highest priority flag)</li>
<li><code>PlayerPreLoginEvent-&gt;getKickMessage()</code> -&gt; <code>PlayerPreLoginEvent-&gt;getDisconnectReason()</code> (now used for logs only, if a disconnect screen message is set for the flag)</li>
<li><code>PlayerPreLoginEvent-&gt;getKickReasons()</code> -&gt; <code>PlayerPreLoginEvent-&gt;getKickFlags()</code></li>
<li><code>PlayerPreLoginEvent-&gt;isKickReasonSet()</code> -&gt; <code>PlayerPreLoginEvent-&gt;isKickFlagSet()</code></li>
<li><code>PlayerPreLoginEvent-&gt;setKickReason()</code> -&gt; <code>PlayerPreLoginEvent-&gt;setKickFlag()</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1530"></a>
&lt;tt&gt;pocketmine\item&lt;/tt&gt;</h2>
<h3><a class="anchor" id="autotoc_md1531"></a>
Highlights</h3>
<ul>
<li><code>ItemFactory</code> has been removed. Vanilla item registration is now done via <code>VanillaItems</code>.<ul>
<li>To get an item at runtime, e.g. iron ingot, use <code>VanillaItems::IRON_INGOT()</code></li>
<li>To get a block as an item, e.g. stone, use <code>VanillaBlocks::STONE()-&gt;asItem()</code></li>
<li>To load an item from legacy ID and meta:<ol type="1">
<li>Use <code>GlobalItemDataHandlers::getUpgrader()-&gt;upgradeItemTypeDataInt()</code> <a class="el" href="protocolto-p.html">to</a> convert the legacy ID and meta <a class="el" href="protocolto-p.html">to</a> <code>SavedItemStackData</code></li>
<li>Pass the itemstack data <a class="el" href="protocolto-p.html">to</a> <code>GlobalItemDataHandlers::getDeserializer()</code> <a class="el" href="protocolto-p.html">to</a> get an <code>Item</code> instance</li>
</ol>
</li>
</ul>
</li>
<li>Items no longer use internal Minecraft string IDs and metadata <a class="el" href="protocolto-p.html">to</a> identify themselves. All APIs associated with legacy IDs and/or meta have been removed.</li>
<li>A new set of runtime item IDs generated from <code>VanillaItems</code> is now used <a class="el" href="protocolto-p.html">to</a> identify item types. These IDs are defined in <code>ItemTypeIds</code>.<ul>
<li>These new IDs are primarily intended for type comparison purposes.</li>
<li>Item type IDs are used at <b>runtime only</b>. They should <b>NOT</b> be stored in configs or databases, as they are not guaranteed <a class="el" href="protocolto-p.html">to</a> remain the same between versions.</li>
</ul>
</li>
<li>In some cases, items may have additional "type data" which provides extra type information about an item. This replaces item metadata in some cases.<ul>
<li>Type data may be used <a class="el" href="protocolto-p.html">to</a> store dynamic type information such as dye colour, potion type, etc.</li>
<li>Items must have the same type ID <b>and</b> type data in order <a class="el" href="protocolto-p.html">to</a> be stackable.</li>
</ul>
</li>
<li>Blocks, when represented as items:<ul>
<li>retain their block type data, but not state data (for example, different colours of concrete don't stack, but things like facing don't affect stackability)</li>
<li>use the negative of their block type ID (e.g. a block with type ID <code>1</code> will have an item type ID of <code>-1</code>).</li>
</ul>
</li>
<li>Durable items (e.g. tools, armour) now use NBT <code>Damage</code> tag <a class="el" href="protocolto-p.html">to</a> store durability (like Minecraft 1.13+), instead of legacy meta values.</li>
<li><code>&amp;$returnedItems</code> reference parameter is now used in some places (e.g. <code>onInteractBlock()</code>) <a class="el" href="protocolto-p.html">to</a> enable actions <a class="el" href="protocolto-p.html">to</a> return items <a class="el" href="protocolto-p.html">to</a> players without caring about whether they are in creative or anything else.<ul>
<li>This eliminates boilerplate code of deciding whether <a class="el" href="protocolto-p.html">to</a> set the player's held item or not, as well as automatically dropping any overflow items that don't fit into the inventory.</li>
<li>This is used for things like filling/emptying buckets and bottles, and equipping armor.</li>
</ul>
</li>
<li>Blocks which previously had separate items, such as mob heads and beds, no longer do. Their item form can be acquired using <code>Block-&gt;asItem()</code> in the same way as every other block. This is facilitated by the new serializer system.</li>
</ul>
<h3><a class="anchor" id="autotoc_md1532"></a>
Implementing new items</h3>
<h4><a class="anchor" id="autotoc_md1533"></a>
In a plugin</h4>
<p>This follows a similar process <a class="el" href="protocolto-p.html">to</a> registering blocks.</p>
<ol type="1">
<li>Get a new type ID using <code>ItemTypeIds::newId()</code> - <em>you'll want <a class="el" href="protocolto-p.html">to</a> keep this in a property somewhere if you want <a class="el" href="protocolto-p.html">to</a> compare using <code>getTypeId()</code> later</em></li>
<li>Set up the item type somewhere - <em>this can be anywhere you like, e.g. a plugin main class property, but using a <code>RegistryTrait</code> class is recommended - you'll need this later <a class="el" href="protocolto-p.html">to</a> create new instances of the item</em></li>
<li>Register a deserializer in <code>ItemDeserializer</code> - <em>needed for the item <a class="el" href="protocolto-p.html">to</a> be recognized when loaded from disk</em></li>
<li>Register a serializer in <code>ItemSerializer</code> - <em>needed for the item <a class="el" href="protocolto-p.html">to</a> be saved <a class="el" href="protocolto-p.html">to</a> disk, and <a class="el" href="protocolto-p.html">to</a> be sent over the network</em></li>
<li>Optionally, register a string alias for the item in <code>StringToItemParser</code> - <em>so that it can be given via <code>/give</code></em></li>
</ol>
<p>To see a demo of how <a class="el" href="protocolto-p.html">to</a> do this in a plugin, see <a href="https://github.com/pmmp/RegisterBlocksDemoPM5">this example plugin</a>.</p>
<p>Again, it's acknowledged this is rather more cumbersome than it should be, but this is an ongoing process.</p>
<h4><a class="anchor" id="autotoc_md1534"></a>
As a PocketMine-MP core contribution</h4>
<p>To register a new vanilla item into the core, the process is slightly different:</p>
<ol type="1">
<li>Instead of using <code>ItemTypeIds::newId()</code>, add a new constant for the block <a class="el" href="protocolto-p.html">to</a> <code>ItemTypeIds</code></li>
<li>Register the new item in <code>VanillaItems</code></li>
<li>Follow steps 3 onwards from the plugin instructions above</li>
</ol>
<h3><a class="anchor" id="autotoc_md1535"></a>
Change list</h3>
<ul>
<li><code>Item</code> is no longer <code>json_encode()</code>-able.<ul>
<li>The original purpose of this was <a class="el" href="protocolto-p.html">to</a> allow items <a class="el" href="protocolto-p.html">to</a> be serialized <a class="el" href="protocolto-p.html">to</a> JSON for crafting data generated from <code>CraftingDataPacket</code>. Due <a class="el" href="protocolto-p.html">to</a> changes in the generation methodology, bypassing <code>Item</code>s entirely, this is no longer necessary.</li>
<li>In addition, <code>jsonSerialize()</code> required the item <a class="el" href="protocolto-p.html">to</a> know about the method by which it will be serialized (since there is no way <a class="el" href="protocolto-p.html">to</a> inject context), creating a cyclic dependency between the <code>Item</code> implementation and its serialization method.</li>
<li>It's relatively easy <a class="el" href="protocolto-p.html">to</a> write a replacement method <a class="el" href="protocolto-p.html">to</a> encode items <a class="el" href="protocolto-p.html">to</a> JSON as you desire.</li>
<li><code>Item::legacyJsonDeserialize()</code> (previously <code>Item::jsonDeserialize()</code>) is retained <a class="el" href="protocolto-p.html">to</a> allow loading legacy data, although it may be removed in the future.</li>
</ul>
</li>
<li>The following classes have been removed:<ul>
<li><code>Bed</code></li>
<li><code>ItemFactory</code></li>
<li><code>ItemIds</code></li>
<li><code>Skull</code></li>
</ul>
</li>
<li>The following classes have been added:<ul>
<li><code>BoatType</code> - enum of all boat types</li>
<li><code>CoralFan</code></li>
<li><code>HoneyBottle</code></li>
<li><code>MedicineType</code></li>
<li><code>Medicine</code></li>
<li><code>Spyglass</code></li>
<li><code>SuspiciousStewType</code></li>
<li><code>SuspiciousStew</code></li>
</ul>
</li>
<li>The following API methods have been added:<ul>
<li><code>protected Item-&gt;describeState(RuntimeDataDescriber $w) : void</code></li>
<li><code>public Armor-&gt;clearCustomColor() : $this</code> - clears the custom color of an armor item</li>
<li><code>public ArmorTypeInfo-&gt;getToughness() : int</code></li>
<li><code>public ArmorTypeInfo-&gt;isFireProof() : bool</code></li>
<li><code>public Boat-&gt;getType() : BoatType</code></li>
<li><code>public Dye-&gt;setColor(\pocketmine\block\utils\DyeColor $color) : $this</code></li>
<li><code>public Item-&gt;getStateId() : int</code> - returns a runtime numeric state ID for comparisons including information such as coral type, dye color, etc. - DO NOT save this <a class="el" href="protocolto-p.html">to</a> disk or databases</li>
<li><code>public Item-&gt;getTypeId() : int</code> - returns a runtime numeric type ID for comparisons - DO NOT save this <a class="el" href="protocolto-p.html">to</a> disk or databases</li>
<li><code>public Item-&gt;isFireProof() : bool</code></li>
<li><code>public ItemIdentifer-&gt;getTypeId() : int</code></li>
<li><code>public Potion-&gt;setType(PotionType $type) : $this</code></li>
<li><code>public SplashPotion-&gt;setType(PotionType $type) : $this</code></li>
<li><code>public StringToItemParser-&gt;lookupAliases(Item $item) : list&lt;string&gt;</code> - returns a list of all registered aliases for the given item</li>
<li><code>public StringToItemParser-&gt;lookupBlockAliases(Block $block) : list&lt;string&gt;</code> - returns a list of all registered aliases for the given block</li>
<li><code>public static ItemIdentifier::fromBlock(Block $block) : self</code></li>
</ul>
</li>
<li>The following API methods have been removed:<ul>
<li><code>Boat-&gt;getWoodType()</code></li>
<li><code>Item-&gt;getId()</code> - for type comparisons, use <code>Item-&gt;getTypeId()</code> instead</li>
<li><code>Item-&gt;getMeta()</code> - use the item's specific API methods <a class="el" href="protocolto-p.html">to</a> compare information such as colour, potion type etc.</li>
<li><code>Item-&gt;hasAnyDamageValue()</code> - for meta wildcard recipe ingredients, use <code>pocketmine\crafting\MetaWildcardRecipeIngredient</code> instead</li>
<li><code>ItemIdentifier-&gt;getId()</code></li>
<li><code>ItemIdentifier-&gt;getMeta()</code></li>
</ul>
</li>
<li>The following API methods have been renamed:<ul>
<li><code>Item::jsonDeserialize()</code> -&gt; <code>Item::legacyJsonDeserialize()</code></li>
</ul>
</li>
<li>The following API methods have signature changes:<ul>
<li><code>ArmorTypeInfo-&gt;__construct()</code> now accepts optional parameters <code>int $toughness</code> and <code>bool $fireProof</code></li>
<li><code>BoatType::__construct()</code> now accepts <code>BoatType $boatType</code> instead of <code>TreeType $woodType</code>.</li>
<li><code>Item-&gt;onAttackEntity()</code> now accepts <code>array&lt;Item&gt; &amp;$returnedItems</code> reference parameter.</li>
<li><code>Item-&gt;onClickAir()</code> now accepts <code>array&lt;Item&gt; &amp;$returnedItems</code> reference parameter.</li>
<li><code>Item-&gt;onDestroyBlock()</code> now accepts <code>array&lt;Item&gt; &amp;$returnedItems</code> reference parameter.</li>
<li><code>Item-&gt;onInteractBlock()</code> now accepts <code>array&lt;Item&gt; &amp;$returnedItems</code> reference parameter.</li>
<li><code>Item-&gt;onReleaseUsing()</code> now accepts <code>array&lt;Item&gt; &amp;$returnedItems</code> reference parameter.</li>
<li><code>ItemIdentifier-&gt;__construct()</code> no longer accepts a <code>$variant</code> parameter, and now expects an item type ID for the ID parameter</li>
<li><code>LegacyStringToItemParser-&gt;addMapping()</code> now accepts a string for ID, instead of an integer</li>
</ul>
</li>
<li>The following API methods have behaviour changes:<ul>
<li><code>Item-&gt;equals()</code>'s <code>$checkDamage</code> parameter is now ignored, as tool damage is now stored as an NBT tag. This parameter wasn't removed due <a class="el" href="protocolto-p.html">to</a> being followed by a second <code>bool</code> parameter, which would potentially end up in the wrong place and silently cause bugs in updated plugins.</li>
<li><code>Item-&gt;equals()</code>'s <code>$checkTags</code> parameter will now cause tool and armor damage <a class="el" href="protocolto-p.html">to</a> be checked if true.</li>
</ul>
</li>
<li>The following enums have new members:<ul>
<li><code>ToolTier</code> has new member <code>NETHERITE</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1536"></a>
&lt;tt&gt;pocketmine\network&lt;/tt&gt;</h2>
<ul>
<li>The following API methods have changed signatures:<ul>
<li><code>NetworkSessionManager-&gt;close()</code> now accepts an additional <code>Translatable|string|null $disconnectScreenMessage</code> parameter.</li>
</ul>
</li>
<li>The following API methods have changed signatures:<ul>
<li><code>query\QueryInfo-&gt;getPlayerList()</code> now returns <code>list&lt;string&gt;</code> instead of <code>list&lt;Player&gt;</code></li>
<li><code>query\QueryInfo-&gt;setPlayerList()</code> now accepts <code>list&lt;string&gt;</code> instead of <code>list&lt;Player&gt;</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1537"></a>
&lt;tt&gt;pocketmine\player&lt;/tt&gt;</h2>
<ul>
<li>The following API methods have changed signatures:<ul>
<li><code>Player-&gt;disconnect()</code> now accepts <code>Translatable|string</code> for <code>$reason</code> instead of <code>string</code> (<a class="el" href="protocolto-p.html">to</a> allow localized disconnect messages)</li>
<li><code>Player-&gt;disconnect()</code> now accepts an additional <code>Translatable|string|null $disconnectScreenMessage</code> parameter, which is the message <a class="el" href="protocolto-p.html">to</a> be displayed on the disconnect screen (the message in <code>$reason</code> is used if null is passed)</li>
<li><code>Player-&gt;kick()</code> now accepts <code>Translatable|string</code> for <code>$reason</code> instead of <code>string</code> (<a class="el" href="protocolto-p.html">to</a> allow localized kick messages)</li>
<li><code>Player-&gt;kick()</code> now accepts an additional <code>Translatable|string|null $disconnectScreenMessage</code> parameter, which is the message <a class="el" href="protocolto-p.html">to</a> be displayed on the disconnect screen (the message in <code>$reason</code> is used if null is passed)</li>
<li><code>Player-&gt;sendJukeboxPopup()</code> now accepts <code>Translatable|string</code> instead of <code>string, string[]</code></li>
</ul>
</li>
<li>The following classes have been removed:<ul>
<li><code>PlayerChunkLoader</code> - deprecated in 4.19.0 (this was technically internal, but never marked as such)</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1538"></a>
&lt;tt&gt;pocketmine\player\chat&lt;/tt&gt;</h2>
<ul>
<li>The following new classes have been added:<ul>
<li><code>ChatFormatter</code> - interface implemented by chat formatters - this is far more powerful than the old API</li>
<li><code>LegacyRawChatFormatter</code> - implements the same behaviour previously used by <code>PlayerChatEvent-&gt;setFormat()</code></li>
<li><code>StandardChatFormatter</code> - formats chat messages in the vanilla Minecraft style</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1539"></a>
&lt;tt&gt;pocketmine\scheduler&lt;/tt&gt;</h2>
<ul>
<li><code>AsyncTask-&gt;setResult()</code> now works with thread-safe objects. This was previously not possible due <a class="el" href="protocolto-p.html">to</a> limitations in the <code>pthreads</code> extension.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1540"></a>
&lt;tt&gt;pocketmine\world&lt;/tt&gt;</h2>
<ul>
<li>The following API methods have been added:<ul>
<li><code>public World-&gt;setDisplayName(string $name) : void</code></li>
</ul>
</li>
<li>The following API methods have changed signatures:<ul>
<li><code>Explosion-&gt;__construct()</code> has the <code>$size</code> parameter renamed <a class="el" href="protocolto-p.html">to</a> <code>$radius</code></li>
</ul>
</li>
<li>The following public properties have been renamed:<ul>
<li><code>Explosion-&gt;size</code> -&gt; <code>Explosion-&gt;radius</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1541"></a>
&lt;tt&gt;pocketmine\world\format&lt;/tt&gt;</h2>
<ul>
<li>Chunks are now considered dirty (modified) by default, unless loaded from a <code>WorldProvider</code> by <code>World</code>. Previously, chunks were considered unmodified by default, which allowed several pathways <a class="el" href="protocolto-p.html">to</a> bugs.</li>
<li>The following classes have been added:<ul>
<li><code>io\GlobalBlockStateHandlers</code> - gives access <a class="el" href="protocolto-p.html">to</a> block data serializer, deserializer, and upgraders</li>
<li><code>io\GlobalItemDataHandlers</code> - gives access <a class="el" href="protocolto-p.html">to</a> item data serializer, deserializer, and upgraders</li>
<li><code>io\LoadedChunkData</code> - represents a chunk loaded from disk, along with information such as whether the chunk was upgraded and what fixes it requires</li>
</ul>
</li>
<li>The following new API methods have been added:<ul>
<li><code>public SubChunk-&gt;getBiomeArray() : PalettedBlockArray</code></li>
</ul>
</li>
<li>The following classes have been removed:<ul>
<li><code>BiomeArray</code> - <code>PalettedBlockArray</code> is now used for 3D biome data</li>
</ul>
</li>
<li>The following API methods have changed signatures:<ul>
<li><code>Chunk-&gt;getBiomeId()</code> now accepts <code>int $x, int $y, int $z</code> instead of <code>int $x, int $z</code></li>
<li><code>Chunk-&gt;setBiomeId()</code> now accepts <code>int $x, int $y, int $z</code> instead of <code>int $x, int $z</code></li>
<li><code>Chunk-&gt;__construct()</code> no longer accepts <code>BiomeArray</code> as a parameter (contained in each subchunk instead)</li>
<li><code>SubChunk-&gt;__construct()</code> now accepts <code>int $emptyBlockId, list&lt;PalettedBlockArray&gt; $blockLayers, PalettedBlockArray $biomes, ?LightArray $blockLight, ?LightArray $skyLight</code> instead of <code>int, list&lt;PalettedBlockArray&gt;, ?LightArray, ?LightArray</code></li>
<li><code>io\WorldProvider-&gt;loadChunk()</code> now returns <code>LoadedChunkData</code> instead of <code>ChunkData</code></li>
<li><code>io\WorldProvider-&gt;getAllChunks()</code> now yields <code>LoadedChunkData</code> instead of <code>ChunkData</code></li>
<li><code>io\ChunkData-&gt;__construct()</code> now accepts <code>array&lt;int, SubChunk&gt;, bool $populated</code> instead of <code>Chunk $chunk</code></li>
</ul>
</li>
<li>The following API methods have been renamed:<ul>
<li><code>Chunk-&gt;getFullBlock()</code> -&gt; <code>Chunk-&gt;getBlockStateId()</code></li>
<li><code>Chunk-&gt;setFullBlock()</code> -&gt; <code>Chunk-&gt;setBlockStateId()</code></li>
<li><code>SubChunk-&gt;getFullBlock()</code> -&gt; <code>SubChunk-&gt;getBlockStateId()</code></li>
<li><code>SubChunk-&gt;setFullBlock()</code> -&gt; <code>SubChunk-&gt;setBlockStateId()</code></li>
</ul>
</li>
<li>The following API interface requirements have been added:<ul>
<li><code>public io\data\WorldData-&gt;setDisplayName(string $value) : void</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1542"></a>
&lt;tt&gt;pocketmine\world\generator\object&lt;/tt&gt;</h2>
<ul>
<li>The following API methods have been removed:<ul>
<li><code>TreeType::fromMagicNumber()</code></li>
<li><code>TreeType-&gt;getMagicNumber()</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1543"></a>
&lt;tt&gt;pocketmine\world\sound&lt;/tt&gt;</h2>
<ul>
<li>The following classes have been added:<ul>
<li><code>CopperWaxApplySound</code></li>
<li><code>CopperWaxRemoveSound</code></li>
<li><code>DyeUseSound</code></li>
<li><code>InkSacUseSound</code></li>
</ul>
</li>
<li>The following enums have new members:<ul>
<li><code>NoteInstrument</code> has new members <code>BELL</code>, <code>FLUTE</code>, <code>CHIME</code>, <code>XYLOPHONE</code>, <code>IRON_XYLOPHONE</code>, <code>COW_BELL</code>, <code>DIDGERIDOO</code>, <code>BIT</code>, <code>BANJO</code>, <code>PLING</code></li>
</ul>
</li>
<li>The following API methods have been removed:<ul>
<li><code>NoteInstrument::fromMagicNumber()</code></li>
<li><code>NoteInstrument-&gt;getMagicNumber()</code></li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md1544"></a>
Internals</h1>
<ul>
<li>All external usages of <code>KnownTranslationKeys</code> are now removed. All localized messages are now sent using <code>Translatable</code> objects (usually from <code>KnownTranslationFactory</code>).</li>
<li>All usages of NBT keys now use class constants instead of hardcoded strings (except for an occasional overlooked one).</li>
<li>Built-in commands now declare their names inside the class constructor, rather than accepting them as parameters. This improves code consistency.</li>
<li>Commands now use an array for permissions internally, instead of a string separated by <code>;</code>.</li>
<li>Make use of <code>Item-&gt;canStackWith()</code> instead of <code>Item-&gt;equals()</code> wherever possible, <a class="el" href="protocolto-p.html">to</a> make the code more readable.</li>
<li>Moved command timings <a class="el" href="protocolto-p.html">to</a> <code>Timings</code>.</li>
<li>Overriding of serializers and deserializers of items and blocks is now consistently disallowed. Since overriding stuff is non-cooperative, it doesn't make any sense in plugins, which must coexist with other plugins. If you want <a class="el" href="protocolto-p.html">to</a> modify the functionality of built-in stuff, you have several alternative options:<ul>
<li>Use existing API (e.g. events, API methods) - most uses of overrides in PM4 and earlier were abuses that could have been done with events</li>
<li>Submit feature proposals or pull requests for new API <a class="el" href="protocolto-p.html">to</a> be added (e.g. new events)</li>
<li>Register completely custom items, and reuse behaviour from the item you want <a class="el" href="protocolto-p.html">to</a> mimic</li>
<li>Fork PocketMine-MP and alter the code directly - this way your plugins aren't pretending <a class="el" href="protocolto-p.html">to</a> be cooperative with other plugins</li>
</ul>
</li>
<li><code>level.dat</code>, block, item, entity, tile and chunk data are now tagged with a version ID as per <code>VersionInfo::WORLD_DATA_VERSION</code>. This allows the server <a class="el" href="protocolto-p.html">to</a> apply fixes <a class="el" href="protocolto-p.html">to</a> older worlds if necessary.</li>
<li>Protocol creative inventory entries are now cached in <code>CreativeInventoryCache</code> <a class="el" href="protocolto-p.html">to</a> improve performance of initial join and game mode changes.</li>
<li>Singletons in the <code>pocketmine\network\mcpe\convert</code> package have been centralized under <code>TypeConverter</code>. In the future, this will be injected where needed, allowing different converters <a class="el" href="protocolto-p.html">to</a> be used for different sessions (useful for multiversion).</li>
<li><code>BlockStateDictionary</code> memory usage is now reduced from 9 MB <a class="el" href="protocolto-p.html">to</a> 3.5 MB using various techniques, including string reuse and binary-encoded states.</li>
<li><code>NetworkSession</code> disconnect APIs now accept <code>Translatable|string</code> instead of <code>string</code> <a class="el" href="protocolto-p.html">to</a> allow localized disconnect messages.</li>
<li><code>NetworkSession</code> disconnect methods have been altered <a class="el" href="protocolto-p.html">to</a> allow specifying a different disconnect reason and disconnection screen message.</li>
<li><code>RuntimeBlockMapping</code> has been renamed <a class="el" href="protocolto-p.html">to</a> <code>BlockTranslator</code>.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1545"></a>
5.0.1</h1>
<p>Released 3rd June 2023.</p>
<h2><a class="anchor" id="autotoc_md1546"></a>
Changes</h2>
<ul>
<li><a href="https://github.com/pmmp/ext-pmmpthread/releases/tag/6.0.1"><code>ext-pmmpthread</code> version 6.0.1</a> is now required (for bug fixes).</li>
</ul>
<h2><a class="anchor" id="autotoc_md1547"></a>
Fixes</h2>
<ul>
<li>Fixed server crash when breaking blocks placed in the same session (mishandled default block states).</li>
<li>Fixed spore blossoms not dropping when broken.</li>
<li>Fixed jukebox music not stopping when destroyed by an explosion.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1548"></a>
Documentation</h2>
<ul>
<li>Added documentation for <code>BlockSpreadEvent-&gt;__construct()</code> parameters. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Généré par&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
